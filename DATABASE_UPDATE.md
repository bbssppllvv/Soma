# üóÑÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–∞–∑—ã –î–∞–Ω–Ω—ã—Ö –¥–ª—è Onboarding –°–∏—Å—Ç–µ–º—ã

## üìã –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–î–ª—è —Ä–∞–±–æ—Ç—ã –Ω–æ–≤–æ–π onboarding —Å–∏—Å—Ç–µ–º—ã —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ü–µ–ª—è–º–∏ –ø–∏—Ç–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü—É `users`:

### –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- `age` (INTEGER) - –≤–æ–∑—Ä–∞—Å—Ç –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ BMR
- `gender` (VARCHAR) - –ø–æ–ª (male/female) –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ BMR  
- `height_cm` (INTEGER) - —Ä–æ—Å—Ç –≤ —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–∞—Ö
- `weight_kg` (INTEGER) - –≤–µ—Å –≤ –∫–∏–ª–æ–≥—Ä–∞–º–º–∞—Ö
- `fitness_goal` (VARCHAR) - —Ü–µ–ª—å (lose/maintain/gain)
- `activity_level` (VARCHAR) - —É—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- `fat_goal_g` (INTEGER) - —Ü–µ–ª—å –ø–æ –∂–∏—Ä–∞–º –≤ –≥—Ä–∞–º–º–∞—Ö
- `carbs_goal_g` (INTEGER) - —Ü–µ–ª—å –ø–æ —É–≥–ª–µ–≤–æ–¥–∞–º –≤ –≥—Ä–∞–º–º–∞—Ö
- `profile_completed_at` (TIMESTAMP) - –∫–æ–≥–¥–∞ –∑–∞–≤–µ—Ä—à–µ–Ω onboarding

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é

### –®–∞–≥ 1: –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
```sql
-- –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ç–∞–±–ª–∏—Ü—ã users
CREATE TABLE users_backup AS SELECT * FROM users;
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π —Å—Ö–µ–º—ã
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ Supabase SQL Editor
cat check_database.sql
```

### –®–∞–≥ 3: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ Supabase SQL Editor
cat database_update.sql
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –¥–æ–±–∞–≤–∏–ª–∏—Å—å
SELECT column_name, data_type, is_nullable 
FROM information_schema.columns 
WHERE table_name = 'users' 
AND column_name IN ('age', 'gender', 'height_cm', 'weight_kg', 'fitness_goal', 'activity_level', 'fat_goal_g', 'carbs_goal_g', 'profile_completed_at')
ORDER BY column_name;
```

## üîß –ö–∞–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤ Supabase

### –ß–µ—Ä–µ–∑ Supabase Dashboard:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç –≤ [Supabase Dashboard](https://app.supabase.com)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **SQL Editor**
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `check_database.sql` –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
6. –°–æ–∑–¥–∞–π—Ç–µ –µ—â–µ –æ–¥–∏–Ω –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
7. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `database_update.sql` –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ
8. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –¥–æ–±–∞–≤–∏–ª–∏—Å—å

### –ß–µ—Ä–µ–∑ CLI (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω):
```bash
# –ï—Å–ª–∏ —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω Supabase CLI
supabase db reset --local  # –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
# –∏–ª–∏
psql "postgresql://[user]:[password]@[host]:[port]/[database]" < database_update.sql
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º—ã:

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞** (redeploy –Ω–∞ Vercel)
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ onboarding**:
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –Ω–æ–≤–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - –ü—Ä–æ–π–¥–∏—Ç–µ –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å onboarding
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑–µ
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**:
   - –ö–æ–º–∞–Ω–¥–∞ `/profile` –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É
   - –ö–æ–º–∞–Ω–¥–∞ `/goals` –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ —Ü–µ–ª–∏

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —É –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–æ—Ñ–∏–ª—å
SELECT 
    telegram_user_id,
    display_name,
    age,
    gender,
    height_cm,
    weight_kg,
    fitness_goal,
    activity_level,
    cal_goal,
    protein_goal_g,
    fat_goal_g,
    carbs_goal_g,
    fiber_goal_g,
    profile_completed_at
FROM users 
WHERE profile_completed_at IS NOT NULL
ORDER BY profile_completed_at DESC;

-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø—Ä–æ—Ñ–∏–ª—è (–¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)
SELECT 
    telegram_user_id,
    display_name,
    cal_goal,
    protein_goal_g,
    fat_goal_g,
    carbs_goal_g,
    fiber_goal_g
FROM users 
WHERE profile_completed_at IS NULL;
```

## üö® Troubleshooting

### –û—à–∏–±–∫–∞ "column already exists"
–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `ADD COLUMN IF NOT EXISTS`, –ø–æ—ç—Ç–æ–º—É –±–µ–∑–æ–ø–∞—Å–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑.

### –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ
–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã –≤ Supabase.

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –≤–∏–¥—è—Ç onboarding
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ–ª—è –¥–æ–±–∞–≤–∏–ª–∏—Å—å –≤ –±–∞–∑—É
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ (redeploy)
3. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à Telegram: –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

### –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ onboarding –ø—Ä–∏ `/start`
- –ü–æ–ª—É—á–∞—é—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ü–µ–ª–∏ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –Ω–æ–≤—ã—Ö –ø–æ–ª—è—Ö

### –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
- –ü–æ–ª—É—á–∞—é—Ç –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π
- –ö–æ–º–∞–Ω–¥–∞ `/profile` –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É
- –ú–æ–≥—É—Ç –ø—Ä–æ–π—Ç–∏ onboarding –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è

### –†–∞—Å—á–µ—Ç —Ü–µ–ª–µ–π:
- BMR —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ –ú–∏—Ñ—Ñ–ª–∏–Ω–∞-–°–∞–Ω –ñ–µ–æ—Ä–∞
- TDEE —É—á–∏—Ç—ã–≤–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –¶–µ–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ —Ü–µ–ª—å (–ø–æ—Ö—É–¥–µ–Ω–∏–µ/–Ω–∞–±–æ—Ä/–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ)

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤–∞—à–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ–≤–æ–π onboarding —Å–∏—Å—Ç–µ–º–æ–π!
