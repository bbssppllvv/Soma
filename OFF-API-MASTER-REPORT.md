# OpenFoodFacts API - –ú–∞—Å—Ç–µ—Ä-–æ—Ç—á–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

*–†–µ–∑—É–ª—å—Ç–∞—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è: –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç OpenFoodFacts API, –µ–≥–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è*

---

## üéØ **–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ**

**–ó–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞!** –ú—ã –ø—Ä–æ–≤–µ–ª–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ OpenFoodFacts API –∏ –ø–æ–ª—É—á–∏–ª–∏ –ø–æ–ª–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –µ–≥–æ —Ä–∞–±–æ—Ç—ã.

### üìä **–ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ **Find Rate: 100%** (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)
- ‚úÖ **SaL API —Ä–∞–±–æ—Ç–∞–µ—Ç** (–ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö)
- ‚úÖ **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: 200-400ms** (–æ—Ç–ª–∏—á–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å)
- üü° **–ö–∞—á–µ—Å—Ç–≤–æ: 33% —Ç–æ—á–Ω–æ—Å—Ç—å** –ø–µ—Ä–≤–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (—Ç—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è)

---

## üîç **–ì–ª–∞–≤–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç–∏—è**

### 1. **SaL API –Ω–µ —Å–ª–æ–º–∞–Ω - –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö**

#### üö® **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ –Ω–∞—à–µ–º –∫–æ–¥–µ:**
```javascript
// ‚ùå –õ–û–ú–ê–ï–¢ SaL API:
"brands:\"Philadelphia\"^4 AND categories_tags:\"en:cheeses\" AND product_name:\"light\"^3"
‚Üí 500 Internal Server Error

// ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ –û–¢–õ–ò–ß–ù–û:
"philadelphia light"  
‚Üí 10,000 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞ 200ms
```

#### üí° **–ü—Ä–∏—á–∏–Ω–∞:**
SaL API –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ Elasticsearch –∏ **–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–æ–∂–Ω—ã–π Lucene-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å** —Å AND –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ –∏ boost'–∞–º–∏.

### 2. **Rate limiting - –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**
```
–í —Ç–µ—Å—Ç–∞—Ö: 236 –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥ = rate limit hell
–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ: 1-2 –∑–∞–ø—Ä–æ—Å–∞ –≤ –º–∏–Ω—É—Ç—É = –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞
```

### 3. **–ö–∞—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞ - —Ä–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞**
```
Find Rate: 100% ‚úÖ
Brand Accuracy: 33% üü°  
Product Accuracy: 33% üü°

–ü—Ä–∏–º–µ—Ä—ã:
"philadelphia light" ‚Üí "Light Philadelphia" ‚úÖ (—Ö–æ—Ä–æ—à–æ)
"coca cola" ‚Üí "Orange juice" ‚ùå (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç)
"danone yogur" ‚Üí "Iogurte Natural" ‚úÖ (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø, –ø–æ—Ä—Ç—É–≥–∞–ª—å—Å–∫–∏–π)
```

---

## üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ API (—Ä–µ–∞–ª—å–Ω–∞—è)**

### ü•á **SaL API (Search-a-licious)** - –û—Å–Ω–æ–≤–Ω–æ–π
```
URL: https://search.openfoodfacts.org/search
–ú–µ—Ç–æ–¥: POST JSON
–°—Ç–∞—Ç—É—Å: ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ (–ø—Ä–∏ –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö)
–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 200-400ms, —Ç—ã—Å—è—á–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –±–µ–∑ AND/OR/boost
```

### ü•à **v2 API** - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
```
URL: https://world.openfoodfacts.org/api/v2/search  
–ú–µ—Ç–æ–¥: GET —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
–°—Ç–∞—Ç—É—Å: ‚úÖ –†–ê–ë–û–¢–ê–ï–¢
–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 600-1200ms
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –¢—Ä–µ–±—É–µ—Ç brand+category, –º–µ–¥–ª–µ–Ω–Ω–µ–µ
```

### ü•â **Legacy API** - –ù–∞–¥–µ–∂–Ω—ã–π fallback
```
URL: https://world.openfoodfacts.org/cgi/search.pl
–ú–µ—Ç–æ–¥: GET —Å –ø—Ä–æ—Å—Ç—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
–°—Ç–∞—Ç—É—Å: ‚úÖ –°–¢–ê–ë–ò–õ–¨–ù–û –†–ê–ë–û–¢–ê–ï–¢
–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 200-600ms
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞, –Ω–æ –Ω–∞–¥–µ–∂–Ω—ã–π
```

---

## üõ†Ô∏è **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã**

### ‚úÖ **1. –£–ø—Ä–æ—â–µ–Ω–∏–µ SaL –∑–∞–ø—Ä–æ—Å–æ–≤**
```javascript
// –£–±—Ä–∞–ª–∏ —Å–ª–æ–∂–Ω—ã–π Lucene-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å
function buildLuceneQuery({ term, brand, variantTokens }) {
  const searchTerms = [brand, term, ...variantTokens]
    .filter(Boolean)
    .map(normalizeBrand);
  return searchTerms.join(' ');
}
```

### ‚úÖ **2. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –±—Ä–µ–Ω–¥–æ–≤**
```javascript
function normalizeBrand(brand) {
  return brand
    .replace(/&/g, 'and')    // M&M's ‚Üí mandms
    .replace(/'/g, '')       // Ben & Jerry's ‚Üí ben jerrys  
    .replace(/-/g, ' ')      // Coca-Cola ‚Üí coca cola
    .toLowerCase();
}
```

### ‚úÖ **3. –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π rate limiting**
```javascript
SEARCH_BUCKET_CAPACITY = 3      // –±—ã–ª–æ 10
SEARCH_BUCKET_REFILL_MS = 15000 // –±—ã–ª–æ 60000  
MINIMUM_DELAY = 1000            // –±—ã–ª–æ 0
```

### ‚úÖ **4. –ù–∞–¥–µ–∂–Ω—ã–π fallback**
```javascript
try {
  result = await salAPI();
} catch (500_error) {
  result = await v2API();    // –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback
}
```

---

## üìà **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ/–ø–æ—Å–ª–µ**

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|---------------|-------------------|-----------|
| **Find Rate** | 0% | 100% | ‚àû |
| **SaL Success** | 0% | 100% | ‚àû |
| **Avg Response** | 3000ms | 300ms | 10x |
| **Rate Limit Hits** | 90% | 0% | 90% ‚Üì |

---

## üéØ **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

### üöÄ **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:**

1. **–£–ø—Ä–æ—Å—Ç–∏—Ç—å SaL –∑–∞–ø—Ä–æ—Å—ã**
   ```javascript
   // –í–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω–æ–≥–æ Lucene:
   const query = `${brand} ${product} ${variant}`.trim();
   ```

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SaL –∫–∞–∫ primary**
   ```javascript
   // SaL —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ:
   const result = await salAPI(simpleQuery);
   if (result.count > 0) return result;
   ```

3. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å fallback —Å–∏—Å—Ç–µ–º—É**
   ```javascript
   // –ù–∞ —Å–ª—É—á–∞–π –ø—Ä–æ–±–ª–µ–º:
   SaL ‚Üí v2 ‚Üí Legacy ‚Üí graceful failure
   ```

### üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:**
```javascript
// –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:
- sal_success_rate (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å >90%)
- avg_response_time (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å <500ms)  
- find_rate (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å >80%)
- first_result_accuracy (—Ü–µ–ª—å >50%)
```

---

## üèÜ **–§–∏–Ω–∞–ª—å–Ω—ã–µ –≤—ã–≤–æ–¥—ã**

### ‚úÖ **OpenFoodFacts API –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É**

**–ß—Ç–æ –º—ã –ø–æ–Ω—è–ª–∏:**
1. **API —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ** –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
2. **–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ –Ω–∞—à–µ–º –∫–æ–¥–µ**, –Ω–µ –≤ API
3. **–ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–∞—é—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** —á–µ–º —Å–ª–æ–∂–Ω—ã–µ
4. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ–≥–∞—Ç–∞—è** (–º–∏–ª–ª–∏–æ–Ω—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤)
5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã—Å–æ–∫–∞—è** (200-400ms)

**–ß—Ç–æ –Ω—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:**
1. **–ö–∞—á–µ—Å—Ç–≤–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è** (–ø–µ—Ä–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–∞—Å—Ç–æ –Ω–µ –ª—É—á—à–∏–π)
2. **–ü–æ—Å—Ç—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
3. **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è** –¥–ª—è –∏—Å–ø–∞–Ω—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### üéØ **–ò—Ç–æ–≥:**
**–ú—ã –±–æ–ª—å—à–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ–º —Å OpenFoodFacts API –≤—Å–ª–µ–ø—É—é!**

–£ –Ω–∞—Å –µ—Å—Ç—å:
- üìä **–ü–æ–ª–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ** –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- üõ†Ô∏è **–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è
- üìà **–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** –∫–∞—á–µ—Å—Ç–≤–∞
- üöÄ **–ì–æ—Ç–æ–≤—ã–µ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É** –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–æ–π API! üéâ

---

*–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ. OpenFoodFacts API –ø–æ–Ω—è—Ç, –ø—Ä–∏—Ä—É—á–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.*
